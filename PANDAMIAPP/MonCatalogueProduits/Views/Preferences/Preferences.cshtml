@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
<div id="calender"></div>

<link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.css" rel="stylesheet" />
<link href="//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.print.css" rel="stylesheet" />

@section Scripts{
    <script src="<https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script> 
    <script src="<//cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script> 
    
    <script>
        $(document).ready(function() {
            var Preferences = [];
            $/ajax({
                type:"GET",
                url : "/home/GetPreferences"
                success : function (data) {
                    $.each(data, function (i, v){
                        Preferences.push({
                            title: v.Subject,
                            description: v.Description,
                            start : moment(v.Start),
                            end : v.End != null ? moment(v.End) : null,
                            color: v.ThemeColor,
                            allDay : v.IsFullDay
                        });
                    })

                    GenerateCalender(PreferenceJourHoraire);
                },
                error: function(error) {
                    alert('failed');
                }
            })

            function GenerateCalender(PreferenceJourHoraire) {
            $('#calender').fullCalendar('destroy')
            $('#calender').fullCalendar({
                contentHeight: 400,
                defaultDate: new Date(),
                timeFormat: 'h(:mm)a',
                header: {
                    left: 'prev,next,today',
                    center:'title',
                    right: 'month,basicWeek,basicDay,agenda'
                },
                PreferenceLimit:true,
                PreferenceColor : '#378006',
                Preferences : Preferences

                })
            }
        })
    </script>


 }